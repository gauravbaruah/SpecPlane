meta:
  id: "{{ component_name | lower | replace(' ', '_') }}"
  name: "{{ component_name }}"
  version: "0.1.0"
  type: "widget"
  level: "component"
  purpose: "{{ purpose_statement }}"
  status: "prototype"

contracts:
  user_interface:
    {% for state in component_states %}
    {{ state }}:
      display: "{{ states[state].display | default('Visual representation for ' + state + ' state') }}"
      user_actions: {{ states[state].actions | default(['view']) | tojson }}
      {% if states[state].data %}
      data_shown: "{{ states[state].data }}"
      {% endif %}
    {% endfor %}

  interactions:
    {% for interaction in user_interactions %}
    - action: "{{ interaction.action }}"
      trigger: "{{ interaction.trigger }}"
      result: "{{ interaction.result }}"
      {% if interaction.validation %}
      validation: "{{ interaction.validation }}"
      {% endif %}
    {% endfor %}

{% if data_displayed or data_captured %}
data_flow:
  {% if data_displayed %}
  displays: "{{ data_displayed }}"
  {% endif %}
  {% if data_captured %}
  captures: "{{ data_captured }}"
  {% endif %}
  {% if data_validation %}
  validation: "{{ data_validation }}"
  {% endif %}
{% endif %}

{% if responsive_behavior %}
responsive_design:
  behavior: "{{ responsive_behavior }}"
  breakpoints:
    - mobile: "{{ responsive.mobile | default('320px-768px') }}"
    - tablet: "{{ responsive.tablet | default('768px-1024px') }}"
    - desktop: "{{ responsive.desktop | default('1024px+') }}"
{% endif %}

{% if accessibility_notes %}
accessibility:
  screen_reader: "{{ accessibility.screen_reader | default('Properly labeled interactive elements') }}"
  keyboard_navigation: "{{ accessibility.keyboard | default('All actions accessible via keyboard') }}"
  color_contrast: "{{ accessibility.contrast | default('WCAG AA compliant') }}"
  {% if accessibility.additional %}
  additional_notes: "{{ accessibility.additional }}"
  {% endif %}
{% endif %}

{% if failure_modes %}
error_handling:
  {% for mode in failure_modes %}
  {{ mode.type }}:
    user_feedback: "{{ mode.user_message | default('Clear error message displayed') }}"
    recovery_action: "{{ mode.recovery | default('Provide retry option') }}"
    {% if mode.fallback %}
    fallback_state: "{{ mode.fallback }}"
    {% endif %}
  {% endfor %}
{% endif %}

{% if edge_cases %}
edge_cases:
  {% for case in edge_cases %}
  {{ case.name }}:
    scenario: "{{ case.scenario }}"
    ui_behavior: "{{ case.ui_response }}"
  {% endfor %}
{% endif %}

{% if api_dependencies or internal_dependencies %}
dependencies:
  {% if api_dependencies %}
  external:
    {% for dep in api_dependencies %}
    - service: "{{ dep.name }}"
      purpose: "{{ dep.purpose }}"
      {% if dep.fallback %}
      offline_fallback: "{{ dep.fallback }}"
      {% endif %}
    {% endfor %}
  {% endif %}
  {% if internal_dependencies %}
  internal:
    {% for dep in internal_dependencies %}
    - "{{ dep }}"
    {% endfor %}
  {% endif %}
{% endif %}

constraints:
  performance:
    initial_render: "{{ performance.render_time | default('<200ms') }}"
    interaction_response: "{{ performance.interaction_time | default('<100ms') }}"
    {% if performance.animation %}
    animation_fps: "{{ performance.animation }}"
    {% endif %}
  
  usability:
    touch_target_size: "{{ usability.touch_size | default('>=44px') }}"
    loading_feedback: "{{ usability.loading | default('Show progress for >1s operations') }}"

observability:
  user_events:
    - "{{ component_name | lower }}.rendered"
    - "{{ component_name | lower }}.interaction.started"
    - "{{ component_name | lower }}.interaction.completed"
    {% if failure_modes %}
    - "{{ component_name | lower }}.error.displayed"
    {% endif %}
  
  metrics:
    - "render_time_p95"
    - "interaction_success_rate"
    - "user_abandonment_rate"
    {% if data_captured %}
    - "form_completion_rate"
    {% endif %}

{% if success_criteria %}
success_criteria:
  {% for criterion in success_criteria %}
  - metric: "{{ criterion.metric }}"
    target: "{{ criterion.target }}"
  {% endfor %}
{% endif %}

tests:
  visual:
    - "Widget renders correctly in all defined states"
    {% for state in component_states %}
    - "{{ state | title }} state displays appropriate visual feedback"
    {% endfor %}
  
  interaction:
    {% for interaction in user_interactions %}
    - "{{ interaction.action | title }} action produces expected result"
    {% endfor %}
  
  accessibility:
    - "Screen reader announces widget purpose and state"
    - "All interactive elements accessible via keyboard"
    - "Color contrast meets WCAG AA standards"
  
  {% if responsive_behavior %}
  responsive:
    - "Widget adapts correctly to mobile viewport"
    - "Widget maintains usability on tablet screens"
    - "Widget utilizes desktop space effectively"
  {% endif %}
  
  {% if edge_cases %}
  edge_cases:
    {% for case in edge_cases %}
    - "{{ case.test_description | default('Handles ' + case.name + ' appropriately') }}"
    {% endfor %}
  {% endif %}