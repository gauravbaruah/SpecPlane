meta:
  id: "{{ component_name | lower | replace(' ', '_') }}"
  name: "{{ component_name }}"
  version: "0.1.0"
  type: "component"
  level: "component"
  purpose: "{{ purpose_statement }}"
  status: "prototype"

contracts:
  interfaces:
    {% for interface in interfaces %}
    - name: "{{ interface.name }}"
      input: "{{ interface.input }}"
      output: "{{ interface.output }}"
      {% if interface.description %}
      description: "{{ interface.description }}"
      {% endif %}
    {% endfor %}

{% if component_states %}
  states:
    {% for state in component_states %}
    - "{{ state }}"
    {% endfor %}
{% endif %}

{% if data_displayed or data_captured %}
data_flow:
  {% if data_displayed %}
  displays: "{{ data_displayed }}"
  {% endif %}
  {% if data_captured %}
  captures: "{{ data_captured }}"
  {% endif %}
{% endif %}

{% if failure_modes %}
failure_handling:
  {% for mode in failure_modes %}
  {{ mode.type }}:
    impact: "{{ mode.impact }}"
    {% if mode.mitigation %}
    mitigation: "{{ mode.mitigation }}"
    {% endif %}
  {% endfor %}
{% endif %}

{% if edge_cases %}
edge_cases:
  {% for case in edge_cases %}
  {{ case.name }}:
    scenario: "{{ case.scenario }}"
    handling: "{{ case.handling }}"
  {% endfor %}
{% endif %}

{% if api_dependencies or internal_dependencies %}
dependencies:
  {% if api_dependencies %}
  external:
    {% for dep in api_dependencies %}
    - "{{ dep }}"
    {% endfor %}
  {% endif %}
  {% if internal_dependencies %}
  internal:
    {% for dep in internal_dependencies %}
    - "{{ dep }}"
    {% endfor %}
  {% endif %}
{% endif %}

{% if performance_requirements %}
constraints:
  performance:
    {% for req in performance_requirements %}
    {{ req.metric }}: "{{ req.target }}"
    {% endfor %}
{% endif %}

{% if security_requirements %}
  security:
    {% for req in security_requirements %}
    {{ req.aspect }}: "{{ req.requirement }}"
    {% endfor %}
{% endif %}

{% if monitoring_requirements %}
observability:
  metrics:
    {% for metric in monitoring_requirements %}
    - "{{ metric }}"
    {% endfor %}
  
  events:
    - "{{ component_name | lower }}.operation.started"
    - "{{ component_name | lower }}.operation.completed"
    {% if failure_modes %}
    - "{{ component_name | lower }}.operation.failed"
    {% endif %}
{% endif %}

{% if success_criteria %}
success_criteria:
  {% for criterion in success_criteria %}
  - metric: "{{ criterion.metric }}"
    target: "{{ criterion.target }}"
  {% endfor %}
{% endif %}

tests:
  acceptance:
    - "Component initializes successfully with valid configuration"
    {% for interface in interfaces %}
    - "Interface '{{ interface.name }}' responds correctly to valid input"
    {% endfor %}
    {% if failure_modes %}
    {% for mode in failure_modes %}
    - "Handles {{ mode.type }} gracefully without crashing"
    {% endfor %}
    {% endif %}
  
  {% if edge_cases %}
  edge_cases:
    {% for case in edge_cases %}
    - "{{ case.test_description | default('Handles ' + case.name + ' scenario correctly') }}"
    {% endfor %}
  {% endif %}